[{"code":{"css":"body {font-family: Arial, Helvetica, sans-serif;}\n* {box-sizing: border-box;}\n\n/* Button used to open the chat form - fixed at the bottom of the page */\n.open-button {\n  background-color: #555;\n  color: white;\n  padding: 16px 20px;\n  border: none;\n  cursor: pointer;\n  opacity: 0.8;\n  position: fixed;\n  bottom: 23px;\n  /* right: 28px; */\n  left: 28px;\n  width: 280px;\n  z-index: 9999;\n}\n\n/* The popup chat - hidden by default */\n.worktime-popup {\n  display: none;\n  position: fixed;\n  bottom: 0;\n  /* right: 15px; */\n  left: 15px;\n  border: 3px solid #f1f1f1;\n  z-index: 9999;\n}\n\n/* Add styles to the form container */\n.form-container {\n  /* max-width: 300px; */\n  padding: 10px;\n  background-color: white;\n}\n\n/* Full-width textarea */\n.form-container .preclass {\n  width: 100%;\n  padding: 15px;\n  margin: 5px 0 22px 0;\n  border: none;\n  background: #f1f1f1;\n  resize: none;\n}\n\n.form-container .labletype {\n    margin-top: 5px;\n}\n\n.form-container td {\n    border: 5px solid white;\n    padding: 10px;\n    background: #f1f1f1;\n}\n\n/* When the textarea gets focus, do something */\n.form-container textarea:focus {\n  background-color: #ddd;\n  outline: none;\n}\n\n/* Set a style for the submit/send button */\n.form-container .btn {\n  background-color: #04AA6D;\n  color: white;\n  padding: 16px 20px;\n  border: none;\n  cursor: pointer;\n  width: 100%;\n  margin-bottom:10px;\n  opacity: 0.8;\n}\n\n/* Add a red background color to the cancel button */\n.form-container .cancel {\n  background-color: red;\n}\n\n/* Add some hover effects to buttons */\n.form-container .btn:hover, .open-button:hover {\n  opacity: 1;\n}\n\n\n\n.form-container .light-text {\n    color:slategray;\n  }\n\n\n\n/*----------------------------------------------------------------------*/\n\n/* Popup container - can be anything you want */\n.wt-popup {\n  position: relative;\n  display: inline-block;\n  cursor: pointer;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  background: transparent;\n}\n\n/* The actual popup */\n.wt-popup .wt-popup-text {\n  visibility: hidden;\n  width: max-content;\n  background-color: #555;\n  color: #fff;\n  text-align: center;\n  border-radius: 6px;\n  padding: 8px 8px;\n  position: absolute;\n  z-index: 1;\n  bottom: 125%;\n  left: 50%;\n  /* margin-left: -80px; */\n}\n\n/* Popup arrow */\n.wt-popup .wt-popuptext::after {\n  content: \"\";\n  position: absolute;\n  top: 100%;\n  left: 50%;\n  margin-left: -5px;\n  border-width: 5px;\n  border-style: solid;\n  border-color: #555 transparent transparent transparent;\n}\n.wt-popup .wt-popup-arrow {\n    visibility: hidden;\n    position: absolute;\n    top: -25%;\n    border-width: 5px;\n    border-style: solid;\n    border-color: #555 transparent transparent transparent;\n  }\n\n/* Toggle this class - hide and show the popup */\n.wt-popup .show {\n  visibility: visible;\n  -webkit-animation: fadeIn 1s;\n  animation: fadeIn 1s;\n}\n\n/* Add animation (fade in the popup) */\n@-webkit-keyframes fadeIn {\n  from {opacity: 0;} \n  to {opacity: 1;}\n}\n\n@keyframes fadeIn {\n  from {opacity: 0;}\n  to {opacity:1 ;}\n}","files":[],"html":"<button class=\"open-button\" id=\"openbutton\" style=\"display: none\" onclick=\"openForm()\">근무시간 계산기</button>\n<div class=\"worktime-popup\" id=\"myForm\">\n  <form class=\"form-container\">\n    <h1>근무시간 계산기</h1>\n    <div class=\"labletype\" style=\"text-align: right\">\n        현재 시각 : <span id=\"wt-now\"></span>\n        <button type=\"button\" class=\"wt-popup\" id=\"wt-popup-nowtime-info\" onclick=\"togglePopupButton(this.id)\">\n            <div class=\"button-img expl\"></div>\n            <div class=\"wt-popup-text\">\n                1분마다 자동으로 갱신되므로, 최대 1분의 오차가 발생할 수 있습니다.<br>\n                수동으로 업데이트하고 싶은 경우 근무시간 계산기를 닫았다 여시기 바랍니다.\n            </div>\n            <div class=\"wt-popup-arrow\"></div>\n        </button>\n    </div>\n    <div class=\"labletype\" id=\"wt-date-warn\" style=\"display: none; font-weight:bold; color: red\">\n        근무표에서 오늘 날짜를 찾을 수 없어 업데이트하지 않았습니다.<br>\n        마우스를 스크롤하여 근무표에서 오늘 날짜가 보이도록 해주세요~<br>\n        (스크롤 후 바로 반영하려면 근무시간 계산기를 닫았다 여세요)\n    </div>\n\n    <div class=\"labletype\">\n        📅 <span id=\"wt-date\"></span> ( ⌚ <span id=\"wt-intime\"></span> 입문 기준 )\n        <button type=\"button\" class=\"wt-popup\" style=\"display: none\" id=\"wt-popup-intime-info\" onclick=\"togglePopupButton(this.id)\">\n            <div class=\"button-img expl\"></div>\n            <div class=\"wt-popup-text\">\n                입문 기록이 없어 현재 시간을 입문 시간으로 간주합니다.\n            </div>\n            <div class=\"wt-popup-arrow\"></div>\n        </button>\n    </div>\n    <table>\n        <tr>\n            <td>#이번 달 근무일이 <span id=\"wt-workday-left\" style=\"font-weight:bold\"></span>일 남았어요~</td>\n        </tr>\n    </table>\n\n    <div class=\"labletype\">\n        📌오늘의 근무시간 : ⏱ <span id=\"wt-today-worktime\" style=\"font-weight:bold\"></span> <span id=\"wt-today-worktime-info\" class=\"light-text\"></span>\n        <button type=\"button\" class=\"wt-popup\" id=\"wt-popup-resttime-info\" onclick=\"togglePopupButton(this.id)\">\n            <div class=\"button-img expl\"></div>\n            <div class=\"wt-popup-text\">\n                휴게시간은 퇴근 후에 GHRP에 반영되므로, 자체적으로 계산하여 반영합니다.<br>\n                ( {체류시간 - 제외시간}이 4.5시간 이상이면 30분, 9시간 이상이면 1시간 )\n            </div>\n            <div class=\"wt-popup-arrow\"></div>\n        </button>\n    </div>\n    <table>\n        <tr>\n            <td>#하루 8시간 기준 :</td>\n            <td>\n                <div>\n                    <span id=\"wt-worktime-left-today-8hr-endtime\"></span> 퇴근까지 (휴게시간 <span id=\"wt-worktime-left-today-8hr-resttime\"></span> 포함)\n                </div>\n                <span id=\"wt-worktime-left-today-8hr\" style=\"font-weight:bold; font-size:150%\"></span> <span class=\"light-text\">필요합니다.</span>\n                <div id=\"wt-worktime-left-today-8hr-message\" style=\"text-align: right\"></div>\n            </td>\n        </tr>\n        <tr>\n            <td>\n                #필요시간/일(<span id=\"wt-worktime-left-per-day\"></span>)\n                <button type=\"button\" class=\"wt-popup\" id=\"wt-popup-leftTimePerDay-info\" onclick=\"togglePopupButton(this.id)\">\n                    <div class=\"button-img expl\"></div>\n                    <div class=\"wt-popup-text\">\n                        어제까지 남은 [월 필수근무 시간](필요) 시간을 남은 근무일로 나눈 값입니다.\n                    </div>\n                    <div class=\"wt-popup-arrow\"></div>\n                </button>\n                &ensp;기준 :\n            </td>\n            <td>\n                <div>\n                    <span id=\"wt-worktime-left-today-real-endtime\"></span> 퇴근까지 (휴게시간 <span id=\"wt-worktime-left-today-real-resttime\"></span> 포함)\n                </div>\n                <span id=\"wt-worktime-left-today-real\" style=\"font-weight:bold; font-size:150%\"></span> <span class=\"light-text\">필요합니다.</span>\n            </td>\n        </tr>\n    </table>\n\n    <div class=\"labletype\">📌어제까지 누적 초과 근무 : ⏱ <span id=\"wt-overtime\" style=\"font-weight:bold\"></span></div>\n    <table>\n        <tr>\n            <td>#지금퇴근하면 :</td>\n            <td>\n                <span id=\"wt-overtime-left-8hr\" style=\"font-weight:bold\"></span> <span class=\"light-text\">남습니다.</span>\n                <button type=\"button\" class=\"wt-popup\" id=\"wt-popup-leftOverTime-info\" onclick=\"togglePopupButton(this.id)\">\n                    <div class=\"button-img expl\"></div>\n                    <div class=\"wt-popup-text\">\n                        앞으로 매일 8시간씩 근무할 때 기준\n                    </div>\n                    <div class=\"wt-popup-arrow\"></div>\n                </button>\n                &emsp;<span id=\"wt-overtime-left-8hr-message\" style=\"text-align: right\"></span>\n                <br>\n                (남은 근무일간 예상 필요시간/일 : <span id=\"wt-overtime-left-per-day\"></span>\n                <button type=\"button\" class=\"wt-popup\" style=\"display: none\" id=\"wt-popup-expectedLeftTimePerDay-info\" onclick=\"togglePopupButton(this.id)\">\n                    <div class=\"button-img expl\"></div>\n                    <div class=\"wt-popup-text\">\n                        오늘이 이번 달의 마지막 근무일입니다.\n                    </div>\n                    <div class=\"wt-popup-arrow\"></div>\n                </button>\n                )\n            </td>\n        </tr>\n    </table>\n\n    <!-- <button type=\"submit\" class=\"btn\">Send</button> -->\n    <button type=\"button\" class=\"btn cancel\" onclick=\"closeForm()\">Close</button>\n  </form>\n</div>\n\n\n<!-- https://www.geeksforgeeks.org/how-to-insert-spaces-tabs-in-text-using-html-css/ -->\n<!-- Regular space: &nbsp; -->\n<!-- Two spaces gap: &ensp; -->\n<!-- Four spaces gap: &emsp; -->\n","js":"// ghrp\\.kr\\.sec\\.samsung\\.net\n\nworkTime: {\n    let workTimeMsg = \"\"\n\n    //----------------------------------------------------- Util\n\n    function time2min(time) {\n        let absTime = time.replace(/ |-/g,\"\")\n        let absMin = +absTime.split(\":\")[0]*60 + +absTime.split(\":\")[1]\n\n        if ( time.includes(\"-\") ) { return -absMin }\n        else { return absMin }\n    }\n\n    function min2time(min) {\n        // let absMin = min >= 0 ? min : -min\n        let absMin = min.toString().replace(/ |-/g,\"\")\n        let absTime = Math.floor(+absMin / 60) + \":\" + (+absMin % 60).toString().padStart(2, \"0\")\n        if ( min.toString().includes(\"-\") ) { return \"-\" + absTime }\n        else { return absTime }\n    }\n\n    function getRestTime(workMin) {\n        let restMin = Math.floor(+workMin / time2min(\"4:30\")) * 30\n        return (restMin > 60 ? 60 : restMin)\n    }\n\n    function getWorkWithRestTime(workMin) {\n        let restMinNeed = 0\n        if (+workMin >= (8*60)) { restMinNeed = 60 }\n        else if (+workMin >= (4*60)) { restMinNeed = 30 }\n        return +workMin + restMinNeed\n    }\n\n    //----------------------------------------------------- Main\n\n    function updateWorkTime() {\n\n        // Get local time\n        let date = new Date()\n        // let currentDate = date.toISOString().split(\"T\")[0] // for utc time\n        let currentDate = date.getFullYear() + \"-\" + (date.getMonth()+1).toString().padStart(2, \"0\") + \"-\" + date.getDate().toString().padStart(2, \"0\")  // for local time\n        let currentTime = +date.getHours()*60 + +date.getMinutes()\n\n\n        // Get GHRP data\n        let GHRP_monthMinWorkTime           = time2min( $(\"dt:contains('월 필수근무 시간') ~ * span:contains('기준')\").next().text() )\n        let GHRP_monthMinWorkTime_worked    = time2min( $(\"dt:contains('월 필수근무 시간') ~ * span:contains('근무')\").next().text() )\n        let GHRP_monthMinWorkTime_necessary = time2min( $(\"dt:contains('월 필수근무 시간') ~ * span:contains('필요')\").next().text() )\n        let GHRP_monthMaxWorkTime_available = time2min( $(\"dt:contains('월 최대근무 시간') ~ * span:contains('가능')\").next().text() )\n\n        let GHRP_overWorkTime               = time2min( $(\"dt:contains('평일 누적 초과근무시간')\").next().text() )\n        let GHRP_maxWorkTimePerDay          = time2min( $(\"dt:contains('일평균 최대근무가능시간')\").next().text() )\n\n        // Calculate more information from GHRP data\n        let GHRP_C_monthMinWorkTime_necessary = GHRP_monthMinWorkTime - GHRP_monthMinWorkTime_worked // \"필요\"는 0 밑으로 떨어지지 않으므로 별도 계산\n\n        let GHRP_C_leftWorkDay_total = (GHRP_maxWorkTimePerDay == 0) ? 1 : Math.round( GHRP_monthMaxWorkTime_available / GHRP_maxWorkTimePerDay )\n        let GHRP_C_leftWorkDay_real  = Math.ceil( (GHRP_C_monthMinWorkTime_necessary + GHRP_overWorkTime) / (8*60) )\n\n        let GHRP_C_minWorkTimePerDay = Math.round( GHRP_monthMinWorkTime_necessary / GHRP_C_leftWorkDay_real )\n\n\n        // TODAY : Get GHRP data\n        let GHRP_todayCell = $(\"button:contains('\" + currentDate + \"')\").parent().parent().parent()\n\n        let GHRP_inTime_RAW          = GHRP_todayCell.next().next().text()\n        let GHRP_inTime_modified_RAW = GHRP_todayCell.next().next().next().text()\n\n        let GHRP_exceptTime = time2min( GHRP_todayCell.next().next().next().next().next().next().next().next().next().next().next().text() )\n\n\n        // TODAY : Calculate more information from GHRP data\n        let GHRP_C_inTime_RAW = (GHRP_inTime_modified_RAW == \"\") ? GHRP_inTime_RAW : GHRP_inTime_modified_RAW\n\n\n        // TODAY : Generate informations from data\n        let altInTime   = time2min( (GHRP_C_inTime_RAW == \"-\") ? min2time(currentTime) : GHRP_C_inTime_RAW )\n\n        let stayTime    = +currentTime - altInTime\n        let restTime    = getRestTime(stayTime - GHRP_exceptTime)\n        let workTime    = (stayTime - GHRP_exceptTime) - restTime\n\n        let todayOutTime_8hr        = altInTime + getWorkWithRestTime(8*60) + GHRP_exceptTime\n        let todayOutTime_necessary  = altInTime + getWorkWithRestTime(GHRP_C_minWorkTimePerDay) + GHRP_exceptTime\n\n        let todayLeftWorkTime_8hr       = todayOutTime_8hr - currentTime\n        let todayLeftWorkTime_necessary = todayOutTime_necessary - currentTime\n\n/// 여기까지 수정함\n\n        let totalLeftMonthMiniMin   = GHRP_monthMinWorkTime_necessary - workTime\n        // let totalLeftOverMin_8hr    = ((GHRP_C_leftWorkDay_total - 1) * (8*60)) - totalLeftMonthMiniMin\n        let totalLeftOverMin_8hr    = ((GHRP_C_leftWorkDay_real - 1) * (8*60)) - totalLeftMonthMiniMin\n\n// alert(\"⏲️⭐❄⚡🔥⏱🕰⏰⌚⏳⌛📌📍💰💸📅📆🗓😤😍😥🧭💪🙏🩺🎉🎮⚖\")\n\n\n        /////////////////////////////////////////////////////////////////////////////////////// DISPLAY area\n\n        // initial area\n        document.getElementById(\"wt-now\").textContent = min2time(currentTime)\n        if (GHRP_todayCell.text().includes(currentDate)) {\n            document.getElementById(\"wt-date-warn\").style.display = \"none\"\n        }\n        else {\n            document.getElementById(\"wt-date-warn\").style.display = \"block\"\n            return\n        }\n\n        // 📅 date area\n        document.getElementById(\"wt-date\").textContent = currentDate\n        document.getElementById(\"wt-intime\").textContent = min2time(altInTime)\n        if (GHRP_C_inTime_RAW == \"-\") {\n            document.getElementById(\"wt-popup-intime-info\").style.display = \"\"\n        }\n        else {\n            document.getElementById(\"wt-popup-intime-info\").style.display = \"none\"\n        }\n        // document.getElementById(\"wt-workday-left\").textContent = GHRP_C_leftWorkDay_total\n        document.getElementById(\"wt-workday-left\").textContent = GHRP_C_leftWorkDay_real\n        // $(\"#wt_date\").html(currentDate)\n\n\n        // 📌오늘의 근무시간\n        document.getElementById(\"wt-today-worktime\").textContent = min2time(workTime)\n        document.getElementById(\"wt-today-worktime-info\").textContent = \"(체류 : \" + min2time(stayTime) + \", 휴게 : \" + min2time(restTime) + \", 제외 : \" + min2time(GHRP_exceptTime) + \")\"\n\n        document.getElementById(\"wt-worktime-left-today-8hr-endtime\").textContent = min2time(todayOutTime_8hr)\n        document.getElementById(\"wt-worktime-left-today-8hr-resttime\").textContent = min2time(getRestTime(getWorkWithRestTime(8*60)))\n        document.getElementById(\"wt-worktime-left-today-8hr\").textContent = min2time(todayLeftWorkTime_8hr)\n        if (todayLeftWorkTime_8hr <= 0) { document.getElementById(\"wt-worktime-left-today-8hr-message\").textContent = \"😤 어서 퇴근하세요!!\" }\n        else if (todayLeftWorkTime_8hr <= 60) { document.getElementById(\"wt-worktime-left-today-8hr-message\").textContent = \"😍 곧 퇴근해도 좋아요~\" }\n        else { document.getElementById(\"wt-worktime-left-today-8hr-message\").textContent = \"😥 퇴근까지 화이팅!\" }\n\n        document.getElementById(\"wt-worktime-left-per-day\").textContent = min2time(GHRP_C_minWorkTimePerDay)\n        document.getElementById(\"wt-worktime-left-today-real-endtime\").textContent = min2time(todayOutTime_necessary)\n        document.getElementById(\"wt-worktime-left-today-real-resttime\").textContent = min2time(getRestTime(getWorkWithRestTime(GHRP_C_minWorkTimePerDay)))\n        document.getElementById(\"wt-worktime-left-today-real\").textContent = min2time(todayLeftWorkTime_necessary)\n        \n\n\n        // 📌어제까지 누적 초과 근무\n        document.getElementById(\"wt-overtime\").textContent = min2time(GHRP_overWorkTime)\n\n        document.getElementById(\"wt-overtime-left-8hr\").textContent = min2time(totalLeftOverMin_8hr)\n        if (totalLeftOverMin_8hr <= 0) { document.getElementById(\"wt-overtime-left-8hr-message\").textContent = \"⏳ 근무시간이 부족해요 ㅠㅠ\" }\n        else if (totalLeftOverMin_8hr <= (20*60)) { document.getElementById(\"wt-overtime-left-8hr-message\").textContent = \"💸 포괄임금 영역입니다.\" }\n        else { document.getElementById(\"wt-overtime-left-8hr-message\").textContent = \"💰 초과근무 중입니다.\" }\n\n        if (GHRP_C_leftWorkDay_real > 1) {\n            document.getElementById(\"wt-overtime-left-per-day\").textContent = min2time( Math.round( totalLeftMonthMiniMin / ( GHRP_C_leftWorkDay_real - 1 ) ) )\n            document.getElementById(\"wt-popup-expectedLeftTimePerDay-info\").style.display = \"none\"\n        }\n        else {\n            document.getElementById(\"wt-overtime-left-per-day\").textContent = \"- \"\n            document.getElementById(\"wt-popup-expectedLeftTimePerDay-info\").style.display = \"\"\n        }\n\n\n    }\n\n\n    //----------------------------------------------------- Interface\n\n    function openForm() {\n        updateWorkTime()\n        document.getElementById(\"myForm\").style.display = \"block\";\n    }\n    \n    function closeForm() {\n        document.getElementById(\"myForm\").style.display = \"none\";\n    }\n\n    function togglePopupButton(buttonId) {\n        let button      = document.getElementById(buttonId);\n        let text        = button.querySelector(\".wt-popup-text\")\n        let arrow       = button.querySelector(\".wt-popup-arrow\")\n        let textRect    = text.getBoundingClientRect()\n\n        if ( (textRect.width / 2) < textRect.left ) {\n            text.style.marginLeft = - (textRect.width / 2) + \"px\"\n        }\n        else {\n            text.style.marginLeft = - (textRect.left) + \"px\"\n        }\n        // popup.style.margin=\"0 0 0 -\" + (popup.clientWidth / 2) + \"px\"\n        text.classList.toggle(\"show\");\n        arrow.classList.toggle(\"show\");\n    }\n\n\n    //----------------------------------------------------- Init\n\n    function autoUpdate() {\n        updateWorkTime()\n        setTimeout(autoUpdate, 1000 * 60); // 1min\n    }\n\n    function initWorkTime() {\n        document.getElementById(\"openbutton\").style.display = \"block\";\n        autoUpdate()\n        openForm()\n    }\n\n    //----------------------------------------------------- Trigger\n\n    function checkWorkTimePage() {\n        let menuTitle=document.querySelector(\"#etcMenuTitle\")\n\n        if (menuTitle !== null) {\n            if (menuTitle.textContent == \"근무시간 현황\") {\n\n                let date = new Date()\n                let currentDate = date.toISOString().split(\"T\")[0]\n\n                if ($(\"button:contains('\" + currentDate + \"')\").text().includes(currentDate)) {\n                    initWorkTime()\n                    return\n                }\n            }\n        }\n\n        setTimeout(checkWorkTimePage, 1000);\n    }\n\n    checkWorkTimePage()\n}\n\n"},"enabled":true,"onLoad":true,"selector":"ghrp\\.kr\\.sec\\.samsung\\.net","topFrameOnly":true}]
